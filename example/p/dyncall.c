#include <stdio.h>

/*
  libname: "./tocall.so", 0
  func_name: "print", 0
  param: 0xFF

  mov_imm Ma, libname
  intr dynl
  mov_imm Mc, param
  mov_imm Ma, func_name
  intr dyncall
  intr dynul
  halt
*/

int main()
{
  FILE *f = fopen("../dyncall.mbin", "wb");
  unsigned char program[] = {
      0x4d, 0x49, 0x4e, 0x00, 0x00, 0x00, 0x00, 0x00, // The first header bytes
      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x38, // The instruction len
      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, // The data len
      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, // The string len

      0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1A,
      0x9C, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x5F,
      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x1A,
      0x14, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1A,
      0x9E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x5F,
      0x9D, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x5F,
      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01,

      0xFF, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
      '.', '/', 't', 'o', 'c', 'a', 'l', 'l', '.', 's',
      'o', '\0', 'p', 'r', 'i', 'n', 't', 0,0,0,0,0,0,0};
  fwrite(program, 1, sizeof(program), f);
  fclose(f);
}