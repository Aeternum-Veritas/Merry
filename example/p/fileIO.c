#include <stdio.h>

/*
  filename: "test.txt"
  msg: "Hello World!"

  mov_imm Ma, filename
  mov_imm Mb, 2 ;; write mode
  intr 159

  mov_imm Ma, msg
  mvo_imm Mc, 12
  intr 162

  intr 160 
  mov_imm Ma, 0
  halt
*/

int main()
{
  FILE *f = fopen("../fileIO.mbin", "wb");
  unsigned char program[] = {
      0x4d, 0x49, 0x4e, 0x00, 0x00, 0x00, 0x00, 0x00, // The first header bytes
      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x48, // The instruction len
      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // The data len
      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, // The string len

      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1A,
      0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x1A,
      0x9F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x5F,
      0x09, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1A,
      0x0D, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x1A,
      0xA2, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x5F,
      0xA0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x5F,
      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1A,
      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01,

      't', 'e', 's', 't', '.', 't', 'x', 't',
      '\0','H', 'e', 'l', 'l', 'o', ' ', 'W', 
      'o', 'r','l','d','!','\n' , 0, 0
      };
  fwrite(program, 1, sizeof(program), f);
  fclose(f);
}